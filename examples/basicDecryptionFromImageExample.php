<?php
  require_once '../vendor/autoload.php';
  use encrypted_images_php\decryption\images;

  // base64 image, this should not contain the text "data:image/png;base64," 
  $data = "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";


  // get key from url if it exists
  if (isset($_GET['key'])) { 
    $key = strip_tag($_GET['key']);
  }

  // set key empty for default if not exists
  if (!isset($key)) {
    $key = "";
  }

  //decrypt the base64 image data
  $decryption = new images();

  // when sending base64 you must set flag json. Name is misleading but thats how it works.
  $decrypted = $decryption->decryptFromImage($data, $key, 'json');
  
  echo $decrypted;